{
  "summary": {
    "title": "Play-Pen-Threat-Model",
    "owner": "Karthik",
    "description": "Test thread model"
  },
  "detail": {
    "contributors": [
      {
        "name": "Lee"
      }
    ],
    "diagrams": [
      {
        "cells": [
          {
            "position": {
              "x": 51,
              "y": 179
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Gitlab"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "id": "c1de2c87-bf2a-488e-9e47-6b5762a295fd",
            "data": {
              "name": "Gitlab",
              "description": "Gitlab pipeline",
              "type": "tm.Actor",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "modelType": "STRIDE",
                  "title": "Gitlab schedule failing to execute",
                  "type": "Tampering",
                  "description": "The gitlab monthly schedule fails to run",
                  "mitigation": "Notify via slack channel if there is a pipeline schedule failure",
                  "threatId": "fbe08854-4a12-406a-b34f-88e5d0937a99",
                  "id": "663de980-6c42-492c-bdd5-658eaa1ba653"
                }
              ],
              "hasOpenThreats": true,
              "providesAuthentication": false
            }
          },
          {
            "position": {
              "x": 358,
              "y": 165
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Secret Rotation\nUtlity"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "id": "8ee223c0-5026-4690-a873-f232e283a8d2",
            "data": {
              "name": "Secret Rotation\nUtlity",
              "description": "",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "modelType": "STRIDE",
                  "title": "New Access Key Not Being Consumed",
                  "type": "Spoofing",
                  "description": "When a new access key is generated, and a gitlab pipeline is triggered for the same, there is a possibility that the pipeline to update the newly generated access key and consume the same, may not be completed and hence the old access key would continue to be in use",
                  "mitigation": "Notify the pipeline repo owner and if not acted within a certain amount of time, auto approve the gitlab job",
                  "threatId": "c7d76d2d-6b31-4bbe-a99d-717dbe918d55",
                  "id": "82fac52b-4941-435a-a67d-34a3c0b68016"
                },
                {
                  "ruleId": "d97bcb80-f96d-44af-869a-d0441761be05",
                  "title": "Vulnerability scanning",
                  "type": "Information disclosure",
                  "modelType": "STRIDE",
                  "status": "Open",
                  "severity": "Medium",
                  "description": "See OWASP Automated Threat #14:\nSystematic enumeration and examination in order to find weaknesses and points where a security vulnerability might exist",
                  "mitigation": "Defence includes providing anti-automation",
                  "threatId": "c9fd19e3-8cde-4322-a4ce-70f6f576b753",
                  "id": "dff0535d-50ed-48ed-ab97-abe9fdc9c8b3"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "modelType": "STRIDE",
                  "title": "Both the keys are in use and hence new key generation fails",
                  "type": "Denial of service",
                  "description": "If both the access keys for the user are in use, then the secret rotation utility will not be able to generate a new key.",
                  "mitigation": "utility to check the oldest among access key and automatically delete it",
                  "threatId": "71b78943-a603-4499-a49c-616d1a2f1aac",
                  "id": "ba05eb8c-8c61-4bac-a33b-8431a912980d"
                }
              ],
              "hasOpenThreats": true,
              "handlesCardPayment": null,
              "isWebApplication": null,
              "handlesGoodsOrServices": null
            }
          },
          {
            "position": {
              "x": 629,
              "y": 167
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "secrets manager"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 4,
            "id": "126be305-0308-4df2-a92e-28536d4f3cbe",
            "data": {
              "name": "secrets manager",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "modelType": "STRIDE",
                  "title": "Unwanted access to secret manager via other IAM Roles",
                  "type": "Information disclosure",
                  "description": "there may be other iam roles in the account which may allow access to this secrets manager",
                  "mitigation": "ensure that there is a resource policy for the secret that allows access only to required principals and denies access to all other principals",
                  "threatId": "95b94edc-234b-4755-bcd9-2d5aff3be336",
                  "id": "4ea747dd-2b78-4e27-aefb-6316874e7179"
                },
                {
                  "id": "d2f5cd0f-1085-41d5-bee6-4bc9e19d45dd",
                  "title": "New STRIDE threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Provide a description for this threat",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": true,
                  "number": 0,
                  "score": ""
                }
              ],
              "hasOpenThreats": true,
              "isALog": false,
              "storesCredentials": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesInventory": null
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "flow 4",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "modelType": "STRIDE",
                  "title": "Unwanted access to secret manager via other IAM Roles",
                  "type": "Information disclosure",
                  "description": "there may be other iam roles in the account which may allow access to this secrets manager",
                  "mitigation": "ensure that there is a resource policy for the secret that allows access only to required principals and denies access to all other principals",
                  "threatId": "95b94edc-234b-4755-bcd9-2d5aff3be336",
                  "id": "4ea747dd-2b78-4e27-aefb-6316874e7179"
                },
                {
                  "ruleId": "d97bcb80-f96d-44af-869a-d0441761be05",
                  "title": "Vulnerability scanning",
                  "type": "Information disclosure",
                  "modelType": "STRIDE",
                  "status": "Open",
                  "severity": "Medium",
                  "description": "See OWASP Automated Threat #14:\nSystematic enumeration and examination in order to find weaknesses and points where a security vulnerability might exist",
                  "mitigation": "Defence includes providing anti-automation",
                  "threatId": "c9fd19e3-8cde-4322-a4ce-70f6f576b753",
                  "id": "dff0535d-50ed-48ed-ab97-abe9fdc9c8b3"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "modelType": "STRIDE",
                  "title": "Both the keys are in use and hence new key generation fails",
                  "type": "Denial of service",
                  "description": "If both the access keys for the user are in use, then the secret rotation utility will not be able to generate a new key.",
                  "mitigation": "utility to check the oldest among access key and automatically delete it",
                  "threatId": "71b78943-a603-4499-a49c-616d1a2f1aac",
                  "id": "ba05eb8c-8c61-4bac-a33b-8431a912980d"
                }
              ],
              "isTrustBoundary": false,
              "providesAuthentication": false,
              "isALog": false,
              "storesCredentials": false,
              "isSigned": false
            },
            "id": "2e063a2f-9d04-470a-ad47-c8c10e57e9f4",
            "labels": [
              {
                "position": 0.5,
                "attrs": {
                  "label": {
                    "text": "geneated secrets"
                  }
                }
              }
            ],
            "source": {
              "x": 445,
              "y": 178
            },
            "target": {
              "cell": "126be305-0308-4df2-a92e-28536d4f3cbe"
            },
            "vertices": [
              {
                "x": 506,
                "y": 231
              },
              {
                "x": 584,
                "y": 220
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "26d1d475-43d3-4587-887b-ff0a98c4896a",
            "source": {
              "x": 170,
              "y": 260
            },
            "target": {
              "cell": "8ee223c0-5026-4690-a873-f232e283a8d2"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "d316da8a-a0d3-4e56-ba96-64a8509af6b1",
            "labels": [],
            "source": {
              "x": 240,
              "y": 460
            },
            "target": {
              "x": 229,
              "y": 455
            },
            "vertices": [
              {
                "x": 240,
                "y": 460
              },
              {
                "x": 217,
                "y": 468
              },
              {
                "x": 68,
                "y": 493
              },
              {
                "x": 51,
                "y": 372
              },
              {
                "x": 49,
                "y": 360
              },
              {
                "x": 26,
                "y": 112
              },
              {
                "x": 139,
                "y": 69
              },
              {
                "x": 237,
                "y": 62
              },
              {
                "x": 290,
                "y": 364
              }
            ]
          }
        ],
        "version": "2.2.0",
        "title": "Data Flow DIagram",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "id": 0,
        "diagramType": "STRIDE"
      }
    ],
    "reviewer": "Jan",
    "diagramTop": 11,
    "threatTop": 101
  },
  "version": "2.2.0"
}